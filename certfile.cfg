# ======================================================
# OpenSSL SAN 证书配置文件
# 用法: openssl req -x509 -newkey rsa:2048 -keyout private.key -out ./public/certfile.crt -days 3650 -config certfile.cfg -nodes -extensions v3_server
# ======================================================

[ req ]
# 核心配置段
distinguished_name  = req_distinguished_name  # 指定主体信息配置段
req_extensions      = v3_req                  # 证书请求使用的扩展配置
x509_extensions     = v3_server               # 自签名证书使用的扩展配置
prompt              = no                      # 关闭交互式提示（所有信息在配置中定义）
default_md          = sha256                  # 使用 SHA-256 哈希算法（现代安全标准）
encrypt_key         = no                      # 不加密私钥文件（便于服务器自动加载）

[ req_distinguished_name ]
# 证书主体信息（展示用，现代浏览器已忽略）
countryName             = US                  # 国家代码（2字母）
stateOrProvinceName     = California          # 州/省名称
localityName            = San Francisco       # 城市名称
organizationName        = My Company Inc.     # 组织名称
organizationalUnitName  = IT Department       # 部门名称
commonName              = My Development Server  # 通用名（仅传统用途）
emailAddress            = admin@example.com   # 管理员邮箱

[ v3_server ]
# ⭐⭐⭐ 证书扩展配置（关键部分）⭐⭐⭐
basicConstraints        = CA:FALSE            # 声明非CA证书（必须为FALSE）
keyUsage                = digitalSignature, keyEncipherment  # 标准Web服务器密钥用途
extendedKeyUsage        = serverAuth, clientAuth  # 启用服务器和客户端认证
subjectAltName          = @alt_names          # 指向SAN定义（浏览器实际验证的部分）
subjectKeyIdentifier    = hash                # 生成主题密钥标识符
authorityKeyIdentifier  = keyid,issuer        # 生成颁发者密钥标识符
nsCertType              = server              # 明确声明为服务器证书

[ v3_req ]
# 证书请求扩展配置（与v3_server保持一致）
basicConstraints        = CA:FALSE
keyUsage                = digitalSignature, keyEncipherment
extendedKeyUsage        = serverAuth
subjectAltName          = @alt_names

[ alt_names ]
# ⭐⭐⭐ 主题备用名（SAN）⭐⭐⭐
# 浏览器实际验证的标识（必须包含所有访问地址）
DNS.1 = localhost        # 本地开发标准域名
IP.1  = 127.0.0.1        # IPv4 环回地址
IP.2  = ::1              # IPv6 环回地址
IP.3  = 192.168.43.234   # 服务器实际IP地址（根据您的网络修改）